simpleProject
from hosts;

card:keyword   |host:keyword   |ip0:ip                                                                           |ip1:ip
eth0           |alpha          |127.0.0.1                                                                        |127.0.0.1
eth1           |alpha          |::1                                                                              |::1
eth0           |beta           |127.0.0.1                                                                        |::1
eth1           |beta           |127.0.0.1                                                                        |127.0.0.2
eth1           |beta           |127.0.0.1                                                                        |128.0.0.1
lo0            |gamma          |fe80::cae2:65ff:fece:feb9                                                        |fe81::cae2:65ff:fece:feb9
eth0           |gamma          |fe80::cae2:65ff:fece:feb9                                                        |127.0.0.3
eth0           |epsilon        |[fe80::cae2:65ff:fece:feb9, fe80::cae2:65ff:fece:fec0, fe80::cae2:65ff:fece:fec1]|fe80::cae2:65ff:fece:fec1
eth1           |epsilon        |null                                                                             |[127.0.0.1, 127.0.0.2, 127.0.0.3]
eth2           |epsilon        |[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]                           |[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]
;

equals
from hosts | sort host, card | where ip0 == ip1;

card:keyword   |host:keyword   |ip0:ip                   |ip1:ip
eth0           |alpha          |127.0.0.1                |127.0.0.1
eth1           |alpha          |::1                      |::1
;

# ignored due to unstable sort
equalityNoSort-Ignore
from hosts | where ip0 == ip1;

card:keyword   |host:keyword   |ip0:ip                                                |ip1:ip
eth0           |alpha          |127.0.0.1                                             |127.0.0.1
eth1           |alpha          |::1                                                   |::1
eth2           |epsilon        |[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]|[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]
;

greaterThanEquals
from hosts | sort host, card | where ip0 >= ip1;

card:keyword   |host:keyword   |ip0:ip                   |ip1:ip
eth0           |alpha          |127.0.0.1                |127.0.0.1
eth1           |alpha          |::1                      |::1
eth0           |beta           |127.0.0.1                |::1
eth0           |gamma          |fe80::cae2:65ff:fece:feb9|127.0.0.3
;

# ignored due to unstable sort
greaterthanEqualsNoSort-Ignore
from hosts | where ip0 >= ip1;

card:keyword   |host:keyword   |ip0:ip                                                |ip1:ip
eth0           |alpha          |127.0.0.1                                             |127.0.0.1
eth1           |alpha          |::1                                                   |::1
eth0           |beta           |127.0.0.1                                             |::1
eth0           |gamma          |fe80::cae2:65ff:fece:feb9                             |127.0.0.3
eth2           |epsilon        |[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]|[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]
;

lessThen
from hosts | sort host, card | where ip0 < ip1;

card:keyword   |host:keyword   |ip0:ip                   |ip1:ip
eth1           |beta           |127.0.0.1                |127.0.0.2
eth1           |beta           |127.0.0.1                |128.0.0.1
lo0            |gamma          |fe80::cae2:65ff:fece:feb9|fe81::cae2:65ff:fece:feb9
;

notEquals
from hosts | sort host, card, ip1 | where ip0 != ip1;

card:keyword   |host:keyword   |ip0:ip                   |ip1:ip
eth0           |beta           |127.0.0.1                |::1
eth1           |beta           |127.0.0.1                |127.0.0.2
eth1           |beta           |127.0.0.1                |128.0.0.1
eth0           |gamma          |fe80::cae2:65ff:fece:feb9|127.0.0.3
lo0            |gamma          |fe80::cae2:65ff:fece:feb9|fe81::cae2:65ff:fece:feb9
;

aggAndSort
from hosts | stats c=count(ip0) by ip0 | sort ip0 | rename ip=ip0;

c:long         |ip:ip
1              |::1
4              |127.0.0.1
5              |fe80::cae2:65ff:fece:feb9
2              |fe81::cae2:65ff:fece:feb9
;

doubleSort
from hosts | sort ip0 asc nulls first, ip1 desc;

card:keyword   |host:keyword   |ip0:ip                   |ip1:ip
eth1           |epsilon        |null                     |127.0.0.1
eth1           |alpha          |::1                      |::1
eth1           |beta           |127.0.0.1                |128.0.0.1
eth1           |beta           |127.0.0.1                |127.0.0.2
eth0           |alpha          |127.0.0.1                |127.0.0.1
eth0           |beta           |127.0.0.1                |::1
lo0            |gamma          |fe80::cae2:65ff:fece:feb9|fe81::cae2:65ff:fece:feb9
eth0           |epsilon        |fe80::cae2:65ff:fece:feb9|fe80::cae2:65ff:fece:fec1
eth0           |gamma          |fe80::cae2:65ff:fece:feb9|127.0.0.3
eth2           |epsilon        |fe81::cae2:65ff:fece:feb9|fe81::cae2:65ff:fece:feb9
;

isNull
from hosts | where is_null(ip0) | project ip0, ip1;

ip0:ip         |ip1:ip
null           |[127.0.0.1, 127.0.0.2, 127.0.0.3]
;

conditional
from hosts | eval eq=case(ip0==ip1, ip0, ip1) | project eq, ip0, ip1;

eq:ip                                                 |ip0:ip                                                                           |ip1:ip
127.0.0.1                                             |127.0.0.1                                                                        |127.0.0.1
::1                                                   |::1                                                                              |::1
::1                                                   |127.0.0.1                                                                        |::1
127.0.0.2                                             |127.0.0.1                                                                        |127.0.0.2
128.0.0.1                                             |127.0.0.1                                                                        |128.0.0.1
fe81::cae2:65ff:fece:feb9                             |fe80::cae2:65ff:fece:feb9                                                        |fe81::cae2:65ff:fece:feb9
127.0.0.3                                             |fe80::cae2:65ff:fece:feb9                                                        |127.0.0.3
fe80::cae2:65ff:fece:fec1                             |[fe80::cae2:65ff:fece:feb9, fe80::cae2:65ff:fece:fec0, fe80::cae2:65ff:fece:fec1]|fe80::cae2:65ff:fece:fec1
[127.0.0.1, 127.0.0.2, 127.0.0.3]                     |null                                                                             |[127.0.0.1, 127.0.0.2, 127.0.0.3]
[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]|[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]                           |[fe81::cae2:65ff:fece:feb9, fe82::cae2:65ff:fece:fec0]
;
